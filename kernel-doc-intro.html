
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>kernel-doc introduction &#8212; LinuxDoc 20200812 documentation</title>
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Install LinuxDoc" href="install.html" />
    <link rel="prev" title="LinuxDoc" href="index.html" />
  <script>DOCUMENTATION_OPTIONS.URL_ROOT = './';</script>
   
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="install.html" title="Install LinuxDoc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="LinuxDoc"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">LinuxDoc 20200812 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="kernel-doc-introduction">
<span id="kernel-doc-intro"></span><h1>kernel-doc introduction<a class="headerlink" href="#kernel-doc-introduction" title="Permalink to this headline">¶</a></h1>
<p>In order to embed <strong>“C” friendly</strong> and extractable documentation into C/C++
source code comments, the Kernel community adopted a consistent style for
documentation comments.  The markup for this documentation is called the
<strong>kernel-doc markup</strong>.  This style embeds the documentation within the source
files, using a few simple conventions for adding documentation paragraphs and
documenting functions and their parameters, structures, unions and their
members, enumerations, and typedefs.  It also includes lightweight markups for
highlights and cross-references in your source code.</p>
<p>The kernel-doc format is deceptively similar to Doxygen, javadoc or <a class="reference external" href="http://www.sphinx-doc.org/en/stable/ext/autodoc.html">Sphinx’s
autodoc</a> which grabs for comments in <a class="reference external" href="http://www.sphinx-doc.org/en/stable/domains.html#the-python-domain">Sphinx’s Python domain</a>.  The kernel-doc
format has a long tradition, e.g. its also well highlighted in your emacs ;) If
you are familiar with <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a>, you might know about <a class="reference external" href="http://www.sphinx-doc.org/en/stable/domains.html#cross-referencing-c-constructs">Sphinx’s C domain</a> markup.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Compared <a class="reference external" href="http://www.sphinx-doc.org/en/stable/domains.html#cross-referencing-c-constructs">Sphinx’s C domain</a>, the <a class="reference internal" href="linuxdoc-howto/kernel-doc-syntax.html#kernel-doc-syntax"><span class="std std-ref">kernel-doc syntax</span></a> is less verbose
and much more coder friendly (<a class="reference internal" href="#kernel-doc-intro-example"><span class="std std-ref">kernel-doc comment</span></a> and <a class="reference internal" href="#kernel-doc-intro-example-out"><span class="std std-ref">reST</span></a>).</p></li>
<li><p>The opening comment mark <code class="docutils literal notranslate"><span class="pre">/**</span></code> is reserved for kernel-doc comments.</p></li>
</ul>
</div>
<p>The <strong>kernel-doc parser</strong> of the LinuxDoc package grabs the documentation from
your C sources and translates the <strong>kernel-doc markup</strong> into proper <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a>.  From
coder’s POV, the C-friendly kernel-doc markup is translated into the more
verbosely <a class="reference external" href="http://www.sphinx-doc.org/en/stable/domains.html#cross-referencing-c-constructs">Sphinx’s C domain</a> which can be included at any place in the
documentation.</p>
<p>Only comments so marked will be considered by the kernel-doc tools, and any
comment so marked must be in kernel-doc format.  The closing comment marker for
kernel-doc comments can be either <code class="docutils literal notranslate"><span class="pre">*/</span></code> or <code class="docutils literal notranslate"><span class="pre">**/</span></code>, but <code class="docutils literal notranslate"><span class="pre">*/</span></code> is preferred in
the Linux kernel tree.  The lines in between should be prefixed by `` * ``
(space star space).</p>
<div class="section" id="by-example">
<span id="kernel-doc-intro-example"></span><h2>by example<a class="headerlink" href="#by-example" title="Permalink to this headline">¶</a></h2>
<p>Lets start with a simple example, documenting our elaborate <em>foobar</em> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * foobar() - short function description of foobar</span>
<span class="cm"> *</span>
<span class="cm"> * @arg1: Describe the first argument to foobar.</span>
<span class="cm"> * @arg2: Describe the second argument to foobar.  One can provide multiple line</span>
<span class="cm"> *        descriptions for arguments.</span>
<span class="cm"> *</span>
<span class="cm"> * A longer description, with more discussion of the function foobar() that</span>
<span class="cm"> * might be useful to those using or modifying it.  Begins with empty comment</span>
<span class="cm"> * line and may include additional embedded empty comment lines.  Within, you</span>
<span class="cm"> * can refer other definitions (e.g. &amp;struct my_struct, &amp;typedef my_typedef,</span>
<span class="cm"> * %CONSTANT, $ENVVAR etc.).</span>
<span class="cm"> *</span>
<span class="cm"> * The longer description can have multiple paragraphs and you can use reST</span>
<span class="cm"> * inline markups like *emphasise* and **emphasis strong**.  You also have reST</span>
<span class="cm"> * block markups like lists or literal available:</span>
<span class="cm"> *</span>
<span class="cm"> * Ordered List:</span>
<span class="cm"> * - item one</span>
<span class="cm"> * - item two</span>
<span class="cm"> * - literal block::</span>
<span class="cm"> *</span>
<span class="cm"> *      a + b --&gt; x</span>
<span class="cm"> *</span>
<span class="cm"> * Return:</span>
<span class="cm"> * Describe the return value of foobar.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">foobar</span><span class="p">(</span><span class="kt">int</span> <span class="n">arg1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg2</span><span class="p">);</span>
</pre></div>
</div>
<p>Pause here and recap what we have seen in the example above.  It is a mix-up of
kernel-doc markup and <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a> markup.  Markups like the function description in
the first line and the following argument descriptions are covered by the
kernel-doc markup, while other markups like the ordered list, the literal block
or the inline emphasis are all a part of the <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a> markup.  The combination of
these markups enables us to write compact (<em>“C” friendly</em>) documentation within
the source code.</p>
<p>From coder’s point, we made a great job documenting our <code class="docutils literal notranslate"><span class="pre">foorbar()</span></code> function.
Now lets take the POV of an author who like to use this description in his
detailed API documentation.  This is where the <a class="reference internal" href="linuxdoc-howto/kernel-doc-directive.html#kernel-doc-directive"><span class="std std-ref">kernel-doc directive</span></a> comes in use.  To include the <code class="docutils literal notranslate"><span class="pre">foobar()</span></code> description,
which might be located in file <code class="docutils literal notranslate"><span class="pre">include/foobar.h</span></code>, the author can use the
kernel-doc directive like this:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">kernel-doc</span><span class="p">::</span> include/foobar.h
    <span class="nc">:functions:</span> foobar
</pre></div>
</div>
<p>Now, if the documentation build process takes places, the kernel-doc directive
runs the <strong>kernel-doc parser</strong> which grabs the documentation and translates the
<strong>kernel-doc markup</strong> into proper <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a>.  Within the output, the directive is
replaced by the generated <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a>.  Later we will see some rendered examples, here
to complete the example lets take a look at the generated doctree, printed out
in <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reST</a> format:</p>
<div class="highlight-rst notranslate" id="kernel-doc-intro-example-out"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="nt">_`foobar`:</span>

<span class="gh">foobar</span>
<span class="gh">======</span>

<span class="p">..</span> <span class="ow">c:function</span><span class="p">::</span> int foobar(int arg1, int arg2)

    short function description of foobar

    <span class="nc">:param int arg1:</span>
        Describe the first argument to foobar.

    <span class="nc">:param int arg2:</span>
        Describe the second argument to foobar.  One can provide multiple line
        descriptions for arguments.

<span class="p">..</span> <span class="nt">_`foobar.description`:</span>

<span class="gh">Description</span>
<span class="gh">-----------</span>

A longer description, with more discussion of the function <span class="na">:c:func:</span><span class="nv">`foobar`</span>
that might be useful to those using or modifying it.  Begins with empty
comment line, and may include additional embedded empty comment lines.
Within you can refer other definitions (e.g. :c:type:`struct my_struct
<span class="nt">&lt;my_struct&gt;</span><span class="nv">`, :c:type:`</span>typedef my_typedef &lt;my_typedef&gt;<span class="nv">`, ``CONSTANT`</span>`,
<span class="s">``$ENVVAR``</span> etc.).

The longer description can have multiple paragraphs and you can use reST
inline markups like <span class="ge">*emphasise*</span> and <span class="gs">**emphasis strong**</span>.  You also have reST

<span class="p">..</span> <span class="nt">_`foobar.ordered-list`:</span>

<span class="gh">Ordered List</span>
<span class="gh">------------</span>


<span class="m">-</span> item one
<span class="m">-</span> item two
<span class="m">-</span> literal block::

     a + b --&gt; x

<span class="p">..</span> <span class="nt">_`foobar.return`:</span>

<span class="gh">Return</span>
<span class="gh">------</span>

Describe the return value of foobar.
</pre></div>
</div>
<p>Compare this reST with the kernel-doc comment from the beginning.  This reST is
what you have to type if do not have kernel-doc markups, isn’t it coder
friendly?  If you look closer, you will also see that there is a subsection
named <em>Ordered List</em>.  Be not surprised, this subsection is also made by a
kernel-doc markup, read on in the the <a class="reference internal" href="linuxdoc-howto/kernel-doc-syntax.html#kernel-doc-syntax"><span class="std std-ref">kernel-doc syntax</span></a> chapter for a
detailed description of the markup.</p>
<p>So far we have hyped the kernel-doc, to be complete we also have to look what
the drawbacks and restrictions are.  In your daily work you won’t discover any
huge drawback, but you will be aware of some restrictions. These are given by
the fact, that in some circumstances the mix of the very condensed kernel-doc
markup and the reST markup will bite each other.  There you will need some
quotes (<code class="docutils literal notranslate"><span class="pre">\</span></code>) to escape, that might partial cutting your joy in kernel-doc.
Anyway, overall you should be able to recognize the daily benefit of using
kernel-doc markup in your projects.</p>
</div>
<div class="section" id="linuxdoc-feature-overview">
<h2>LinuxDoc feature overview<a class="headerlink" href="#linuxdoc-feature-overview" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>kernel-doc</dt><dd><p>A “C” friendly markup, the parser, the Sphinx-doc extension and some tools.
The kernel-doc markup embeds documentation within the C source files, using a
few simple conventions. The parser grabs the documentation from source and
generates proper reST <a class="reference internal" href="#kernel-doc-intro"><span class="std std-ref">[ref]</span></a>.  The parser is written
in Python and its API is used by the corresponding Sphinx-doc extension.
Command line tools shipped with:</p>
<ul class="simple">
<li><p>kernel-autodoc: Suitable for automatic API documentation <a class="reference internal" href="cmd-line.html#kernel-autodoc"><span class="std std-ref">[ref]</span></a>.</p></li>
<li><p>kernel-lintdoc: <em>Lint</em> kernel-doc comments from source code <a class="reference internal" href="cmd-line.html#kernel-lintdoc"><span class="std std-ref">[ref]</span></a>.</p></li>
<li><p>kernel-doc: A command line interface for kernel-doc’s parser API <a class="reference internal" href="cmd-line.html#kernel-doc-cmd"><span class="std std-ref">[ref]</span></a>.</p></li>
</ul>
</dd>
<dt>kernel-doc-man</dt><dd><p>A man page builder. An extension/replacement of the common Sphinx-doc <em>man</em>
builder also integrated in the kernel-doc Sphinx-doc extension <a class="reference internal" href="linuxdoc-howto/man-pages.html#man-pages"><span class="std std-ref">[ref]</span></a>.</p>
</dd>
<dt>flat-table</dt><dd><p>A diff and author friendly list-table replacement with <em>column-span</em>,
<em>row-span</em> and <em>auto-span</em> <a class="reference internal" href="linuxdoc-howto/table-markup.html#rest-flat-table"><span class="std std-ref">[ref]</span></a>.</p>
</dd>
<dt>cdomain</dt><dd><p>A customized <a class="reference external" href="http://www.sphinx-doc.org/en/stable/domains.html#cross-referencing-c-constructs">Sphinx’s C Domain</a> extension. Suitable for demanding projects
<a class="reference internal" href="linuxdoc-howto/cdomain.html#customized-c-domain"><span class="std std-ref">[ref]</span></a>.</p>
</dd>
<dt>kfigure</dt><dd><p>Sphinx extension which implements scalable image handling. Simplifies image
handling from the author’s POV. Wins where Sphinx-doc image handling
fails. Whatever graphic tools available on your build host, you always get the
best output-format. Graphviz’s DOT format included <a class="reference internal" href="linuxdoc-howto/kfigure.html#kfigure"><span class="std std-ref">[ref]</span></a>.</p>
</dd>
<dt>kernel-include</dt><dd><p>A replacement for the <code class="docutils literal notranslate"><span class="pre">include</span></code> reST directive. The directive expand
environment variables in the path name and allows to include files from
arbitrary locations ref:<cite>[ref] &lt;kernel-include-directive&gt;</cite>.</p>
</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/darmarIT_logo_128.png" alt="Logo"/>
            </a></p>
  

  <h3>Project Links</h3>
  <ul>
    <li><a href="https://return42.github.io/linuxdoc">Home</a>
  
    <li><a href="https://github.com/return42/linuxdoc">Source</a>
  
    <li><a href="https://return42.github.io/linuxdoc/linuxdoc-api/linuxdoc.html">API</a>
  </ul><h3>Navigation</h3>
<ul>
  <li><a href="index.html">Overview</a>
    <ul>
          <li>Previous: <a href="index.html" title="previous chapter">LinuxDoc</a>
          <li>Next: <a href="install.html" title="next chapter">Install LinuxDoc</a>
    </ul>
  </li>
</ul>
  <h3>Contents</h3>
  <ul>
<li><a class="reference internal" href="#">kernel-doc introduction</a><ul>
<li><a class="reference internal" href="#by-example">by example</a></li>
<li><a class="reference internal" href="#linuxdoc-feature-overview">LinuxDoc feature overview</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020 Markus Heiser.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  <script src="_static/version_warning_offset.js"></script>

  </body>
</html>